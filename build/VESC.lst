ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"VESC.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.handle_vesc_can_recv,"ax",%progbits
  20              		.align	1
  21              		.global	handle_vesc_can_recv
  22              		.syntax unified
  23              		.thumb
  24              		.thumb_func
  26              	handle_vesc_can_recv:
  27              	.LFB3:
  28              		.file 1 "Src/VESC.c"
   1:Src/VESC.c    **** //
   2:Src/VESC.c    **** // Created by julia on 10/21/19.
   3:Src/VESC.c    **** //
   4:Src/VESC.c    **** 
   5:Src/VESC.c    **** #include "VESC.h"
   6:Src/VESC.c    **** #include "can_manager.h"
   7:Src/VESC.c    **** #include "stdint.h"
   8:Src/VESC.c    **** #include "stdlib.h"
   9:Src/VESC.c    **** #include "string.h"
  10:Src/VESC.c    **** #include "types.h"
  11:Src/VESC.c    **** 
  12:Src/VESC.c    **** #define VESC_MAP_SIZE 16
  13:Src/VESC.c    **** VESC vesc_map[VESC_MAP_SIZE] = {{0}};
  14:Src/VESC.c    **** static S32 vesc_count = 0;
  15:Src/VESC.c    **** 
  16:Src/VESC.c    **** void vesc_system_init() {
  17:Src/VESC.c    ****   registerCANMsgHandler(0xFFFFFFFFu, handle_vesc_can_recv);
  18:Src/VESC.c    **** }
  19:Src/VESC.c    **** 
  20:Src/VESC.c    **** void vesc_send_message(VESC const* vesc, U8 const type, U8 const* buffer,
  21:Src/VESC.c    ****                        S32 const length) {
  22:Src/VESC.c    ****   do_send_can_message(type << 8u | vesc->id, buffer, length);
  23:Src/VESC.c    **** }
  24:Src/VESC.c    **** 
  25:Src/VESC.c    **** VESC* create_vesc(U8 const id, S32 const pole_pairs) {
  26:Src/VESC.c    ****   VESC* vesc = &vesc_map[vesc_count];
  27:Src/VESC.c    ****   ++vesc_count;
  28:Src/VESC.c    ****   vesc->id = id;
  29:Src/VESC.c    ****   vesc->pole_pairs = pole_pairs;
  30:Src/VESC.c    ****   return vesc;
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 2


  31:Src/VESC.c    **** }
  32:Src/VESC.c    **** 
  33:Src/VESC.c    **** // https://github.com/vedderb/bldc/blob/a141e750bb667cd828e9fd5e5b185724f22fae0b/comm_can.c#L1114
  34:Src/VESC.c    **** void handle_vesc_can_recv(rmc_can_msg const msg) {
  29              		.loc 1 34 50 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 24
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33 0000 30B5     		push	{r4, r5, lr}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 12
  36              		.cfi_offset 4, -12
  37              		.cfi_offset 5, -8
  38              		.cfi_offset 14, -4
  39 0002 2DED028B 		vpush.64	{d8}
  40              	.LCFI1:
  41              		.cfi_def_cfa_offset 20
  42              		.cfi_offset 80, -20
  43              		.cfi_offset 81, -16
  44 0006 87B0     		sub	sp, sp, #28
  45              	.LCFI2:
  46              		.cfi_def_cfa_offset 48
  47 0008 6C46     		mov	r4, sp
  48 000a 84E80F00 		stm	r4, {r0, r1, r2, r3}
  35:Src/VESC.c    ****   U8 const vesc_id = msg.id & 0xFFu;
  49              		.loc 1 35 3 view .LVU1
  50              		.loc 1 35 25 is_stmt 0 view .LVU2
  51 000e 0446     		mov	r4, r0
  52              		.loc 1 35 12 view .LVU3
  53 0010 C0B2     		uxtb	r0, r0
  54              	.LVL0:
  36:Src/VESC.c    ****   VESC* ptr = NULL;
  55              		.loc 1 36 3 is_stmt 1 view .LVU4
  37:Src/VESC.c    ****   for (S32 i = 0; i < vesc_count; ++i) {
  56              		.loc 1 37 3 view .LVU5
  57              	.LBB2:
  58              		.loc 1 37 8 view .LVU6
  59              		.loc 1 37 12 is_stmt 0 view .LVU7
  60 0012 0023     		movs	r3, #0
  61              		.loc 1 37 3 view .LVU8
  62 0014 00E0     		b	.L2
  63              	.LVL1:
  64              	.L3:
  65              		.loc 1 37 35 is_stmt 1 discriminator 2 view .LVU9
  66 0016 0133     		adds	r3, r3, #1
  67              	.LVL2:
  68              	.L2:
  69              		.loc 1 37 19 discriminator 1 view .LVU10
  70              		.loc 1 37 21 is_stmt 0 discriminator 1 view .LVU11
  71 0018 6F4A     		ldr	r2, .L17
  72 001a 1268     		ldr	r2, [r2]
  73              		.loc 1 37 3 discriminator 1 view .LVU12
  74 001c 9A42     		cmp	r2, r3
  75 001e 0BDD     		ble	.L15
  38:Src/VESC.c    ****     if (vesc_map[i].id == vesc_id) {
  76              		.loc 1 38 5 is_stmt 1 view .LVU13
  77              		.loc 1 38 20 is_stmt 0 view .LVU14
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 3


  78 0020 C3EB0312 		rsb	r2, r3, r3, lsl #4
  79 0024 6D49     		ldr	r1, .L17+4
  80 0026 11F82220 		ldrb	r2, [r1, r2, lsl #2]	@ zero_extendqisi2
  81              		.loc 1 38 8 view .LVU15
  82 002a 8242     		cmp	r2, r0
  83 002c F3D1     		bne	.L3
  39:Src/VESC.c    ****       ptr = &vesc_map[i];
  84              		.loc 1 39 7 is_stmt 1 view .LVU16
  85              		.loc 1 39 11 is_stmt 0 view .LVU17
  86 002e C3EB0313 		rsb	r3, r3, r3, lsl #4
  87              	.LVL3:
  88              		.loc 1 39 11 view .LVU18
  89 0032 01EB8305 		add	r5, r1, r3, lsl #2
  90              	.LVL4:
  40:Src/VESC.c    ****       break;
  91              		.loc 1 40 7 is_stmt 1 view .LVU19
  92 0036 00E0     		b	.L4
  93              	.LVL5:
  94              	.L15:
  95              		.loc 1 40 7 is_stmt 0 view .LVU20
  96              	.LBE2:
  36:Src/VESC.c    ****   for (S32 i = 0; i < vesc_count; ++i) {
  97              		.loc 1 36 9 view .LVU21
  98 0038 0025     		movs	r5, #0
  99              	.LVL6:
 100              	.L4:
  41:Src/VESC.c    ****     }
  42:Src/VESC.c    ****   }
  43:Src/VESC.c    ****   if (ptr != NULL) {
 101              		.loc 1 43 3 is_stmt 1 view .LVU22
 102              		.loc 1 43 6 is_stmt 0 view .LVU23
 103 003a ADB1     		cbz	r5, .L1
 104              	.LBB3:
  44:Src/VESC.c    ****     U8 cmd_id = msg.id >> 8u;
 105              		.loc 1 44 5 is_stmt 1 view .LVU24
 106              	.LVL7:
  45:Src/VESC.c    ****     S32 index = 0;
 107              		.loc 1 45 5 view .LVU25
 108              		.loc 1 45 9 is_stmt 0 view .LVU26
 109 003c 0023     		movs	r3, #0
 110 003e 0593     		str	r3, [sp, #20]
  46:Src/VESC.c    ****     U8 const* buf = msg.buf;
 111              		.loc 1 46 5 is_stmt 1 view .LVU27
 112              	.LVL8:
  47:Src/VESC.c    ****     switch (cmd_id) {
 113              		.loc 1 47 5 view .LVU28
 114 0040 C4F30724 		ubfx	r4, r4, #8, #8
 115              	.LVL9:
 116              		.loc 1 47 5 is_stmt 0 view .LVU29
 117 0044 093C     		subs	r4, r4, #9
 118 0046 122C     		cmp	r4, #18
 119 0048 0ED8     		bhi	.L1
 120 004a DFE804F0 		tbb	[pc, r4]
 121              	.L9:
 122 004e 0A       		.byte	(.L13-.L9)/2
 123 004f 0D       		.byte	(.L1-.L9)/2
 124 0050 0D       		.byte	(.L1-.L9)/2
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 4


 125 0051 0D       		.byte	(.L1-.L9)/2
 126 0052 0D       		.byte	(.L1-.L9)/2
 127 0053 38       		.byte	(.L12-.L9)/2
 128 0054 56       		.byte	(.L11-.L9)/2
 129 0055 74       		.byte	(.L10-.L9)/2
 130 0056 0D       		.byte	(.L1-.L9)/2
 131 0057 0D       		.byte	(.L1-.L9)/2
 132 0058 0D       		.byte	(.L1-.L9)/2
 133 0059 0D       		.byte	(.L1-.L9)/2
 134 005a 0D       		.byte	(.L1-.L9)/2
 135 005b 0D       		.byte	(.L1-.L9)/2
 136 005c 0D       		.byte	(.L1-.L9)/2
 137 005d 0D       		.byte	(.L1-.L9)/2
 138 005e 0D       		.byte	(.L1-.L9)/2
 139 005f 0D       		.byte	(.L1-.L9)/2
 140 0060 AC       		.byte	(.L8-.L9)/2
 141 0061 00       		.p2align 1
 142              	.L13:
  48:Src/VESC.c    ****       case VESC_PACKET_STATUS: {
  49:Src/VESC.c    ****         if (msg.length < 8) {
 143              		.loc 1 49 9 is_stmt 1 view .LVU30
 144              		.loc 1 49 16 is_stmt 0 view .LVU31
 145 0062 039B     		ldr	r3, [sp, #12]
 146              		.loc 1 49 12 view .LVU32
 147 0064 072B     		cmp	r3, #7
 148 0066 03DC     		bgt	.L16
 149              	.LVL10:
 150              	.L1:
 151              		.loc 1 49 12 view .LVU33
 152              	.LBE3:
  50:Src/VESC.c    ****           break;
  51:Src/VESC.c    ****         }
  52:Src/VESC.c    ****         // To turn this into an actual RPM, divide by 6 for the turnigy motors
  53:Src/VESC.c    ****         ptr->erpm = (F32)buffer_pop_int32(buf, &index);
  54:Src/VESC.c    ****         ptr->current = (F32)buffer_pop_int16(buf, &index) / 10.0f;
  55:Src/VESC.c    ****         ptr->duty = (F32)buffer_pop_int16(buf, &index) / 1000.0f;
  56:Src/VESC.c    ****         break;
  57:Src/VESC.c    ****       }
  58:Src/VESC.c    ****       case VESC_PACKET_STATUS_2: {
  59:Src/VESC.c    ****         if (msg.length < 8) {
  60:Src/VESC.c    ****           break;
  61:Src/VESC.c    ****         }
  62:Src/VESC.c    ****         ptr->amp_hours = (F32)buffer_pop_int32(buf, &index) / 1e4f;
  63:Src/VESC.c    ****         ptr->amp_hours_charged = (F32)buffer_pop_int32(buf, &index) / 1e4f;
  64:Src/VESC.c    ****         break;
  65:Src/VESC.c    ****       }
  66:Src/VESC.c    ****       case VESC_PACKET_STATUS_3: {
  67:Src/VESC.c    ****         if (msg.length < 8) {
  68:Src/VESC.c    ****           break;
  69:Src/VESC.c    ****         }
  70:Src/VESC.c    ****         ptr->watt_hours = (F32)buffer_pop_int32(buf, &index) / 1e4f;
  71:Src/VESC.c    ****         ptr->watt_hours_charged = (F32)buffer_pop_int32(buf, &index) / 1e4f;
  72:Src/VESC.c    ****         break;
  73:Src/VESC.c    ****       }
  74:Src/VESC.c    ****       case VESC_PACKET_STATUS_4: {
  75:Src/VESC.c    ****         if (msg.length < 8) {
  76:Src/VESC.c    ****           break;
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 5


  77:Src/VESC.c    ****         }
  78:Src/VESC.c    ****         ptr->temp_fet = (F32)buffer_pop_int16(buf, &index) / 10.0f;
  79:Src/VESC.c    ****         ptr->temp_motor = (F32)buffer_pop_int16(buf, &index) / 10.0f;
  80:Src/VESC.c    ****         ptr->current_in = (F32)buffer_pop_int16(buf, &index) / 10.0f;
  81:Src/VESC.c    ****         ptr->pid_pos_now = (F32)buffer_pop_int16(buf, &index) / 50.0f;
  82:Src/VESC.c    ****         break;
  83:Src/VESC.c    ****       }
  84:Src/VESC.c    ****       case VESC_PACKET_STATUS_5: {
  85:Src/VESC.c    ****         if (msg.length < 6) {
  86:Src/VESC.c    ****           break;
  87:Src/VESC.c    ****         }
  88:Src/VESC.c    ****         ptr->tacho_value = buffer_pop_int32(buf, &index);
  89:Src/VESC.c    ****         ptr->v_in = (F32)buffer_pop_int16(buf, &index) / 1e1f;
  90:Src/VESC.c    ****         break;
  91:Src/VESC.c    ****       }
  92:Src/VESC.c    ****     }
  93:Src/VESC.c    ****   }
  94:Src/VESC.c    **** }
 153              		.loc 1 94 1 view .LVU34
 154 0068 07B0     		add	sp, sp, #28
 155              	.LCFI3:
 156              		.cfi_remember_state
 157              		.cfi_def_cfa_offset 20
 158              		@ sp needed
 159 006a BDEC028B 		vldm	sp!, {d8}
 160              	.LCFI4:
 161              		.cfi_restore 80
 162              		.cfi_restore 81
 163              		.cfi_def_cfa_offset 12
 164 006e 30BD     		pop	{r4, r5, pc}
 165              	.LVL11:
 166              	.L16:
 167              	.LCFI5:
 168              		.cfi_restore_state
 169              	.LBB4:
  53:Src/VESC.c    ****         ptr->current = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 170              		.loc 1 53 9 is_stmt 1 view .LVU35
  53:Src/VESC.c    ****         ptr->current = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 171              		.loc 1 53 26 is_stmt 0 view .LVU36
 172 0070 05A9     		add	r1, sp, #20
 173 0072 01A8     		add	r0, sp, #4
 174              	.LVL12:
  53:Src/VESC.c    ****         ptr->current = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 175              		.loc 1 53 26 view .LVU37
 176 0074 FFF7FEFF 		bl	buffer_pop_int32
 177              	.LVL13:
  53:Src/VESC.c    ****         ptr->current = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 178              		.loc 1 53 26 view .LVU38
 179 0078 07EE900A 		vmov	s15, r0	@ int
  53:Src/VESC.c    ****         ptr->current = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 180              		.loc 1 53 21 view .LVU39
 181 007c F8EEE77A 		vcvt.f32.s32	s15, s15
  53:Src/VESC.c    ****         ptr->current = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 182              		.loc 1 53 19 view .LVU40
 183 0080 C5ED027A 		vstr.32	s15, [r5, #8]
  54:Src/VESC.c    ****         ptr->duty = (F32)buffer_pop_int16(buf, &index) / 1000.0f;
 184              		.loc 1 54 9 is_stmt 1 view .LVU41
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 6


  54:Src/VESC.c    ****         ptr->duty = (F32)buffer_pop_int16(buf, &index) / 1000.0f;
 185              		.loc 1 54 29 is_stmt 0 view .LVU42
 186 0084 05A9     		add	r1, sp, #20
 187 0086 01A8     		add	r0, sp, #4
 188              	.LVL14:
  54:Src/VESC.c    ****         ptr->duty = (F32)buffer_pop_int16(buf, &index) / 1000.0f;
 189              		.loc 1 54 29 view .LVU43
 190 0088 FFF7FEFF 		bl	buffer_pop_int16
 191              	.LVL15:
  54:Src/VESC.c    ****         ptr->duty = (F32)buffer_pop_int16(buf, &index) / 1000.0f;
 192              		.loc 1 54 29 view .LVU44
 193 008c 07EE900A 		vmov	s15, r0	@ int
  54:Src/VESC.c    ****         ptr->duty = (F32)buffer_pop_int16(buf, &index) / 1000.0f;
 194              		.loc 1 54 24 view .LVU45
 195 0090 F8EEE77A 		vcvt.f32.s32	s15, s15
  54:Src/VESC.c    ****         ptr->duty = (F32)buffer_pop_int16(buf, &index) / 1000.0f;
 196              		.loc 1 54 59 view .LVU46
 197 0094 F2EE046A 		vmov.f32	s13, #1.0e+1
 198 0098 87EEA67A 		vdiv.f32	s14, s15, s13
  54:Src/VESC.c    ****         ptr->duty = (F32)buffer_pop_int16(buf, &index) / 1000.0f;
 199              		.loc 1 54 22 view .LVU47
 200 009c 85ED037A 		vstr.32	s14, [r5, #12]
  55:Src/VESC.c    ****         break;
 201              		.loc 1 55 9 is_stmt 1 view .LVU48
  55:Src/VESC.c    ****         break;
 202              		.loc 1 55 26 is_stmt 0 view .LVU49
 203 00a0 05A9     		add	r1, sp, #20
 204 00a2 01A8     		add	r0, sp, #4
 205              	.LVL16:
  55:Src/VESC.c    ****         break;
 206              		.loc 1 55 26 view .LVU50
 207 00a4 FFF7FEFF 		bl	buffer_pop_int16
 208              	.LVL17:
  55:Src/VESC.c    ****         break;
 209              		.loc 1 55 26 view .LVU51
 210 00a8 07EE900A 		vmov	s15, r0	@ int
  55:Src/VESC.c    ****         break;
 211              		.loc 1 55 21 view .LVU52
 212 00ac F8EEE77A 		vcvt.f32.s32	s15, s15
  55:Src/VESC.c    ****         break;
 213              		.loc 1 55 56 view .LVU53
 214 00b0 DFED4B6A 		vldr.32	s13, .L17+8
 215 00b4 87EEA67A 		vdiv.f32	s14, s15, s13
  55:Src/VESC.c    ****         break;
 216              		.loc 1 55 19 view .LVU54
 217 00b8 85ED047A 		vstr.32	s14, [r5, #16]
  56:Src/VESC.c    ****       }
 218              		.loc 1 56 9 is_stmt 1 view .LVU55
 219 00bc D4E7     		b	.L1
 220              	.LVL18:
 221              	.L12:
  59:Src/VESC.c    ****           break;
 222              		.loc 1 59 9 view .LVU56
  59:Src/VESC.c    ****           break;
 223              		.loc 1 59 16 is_stmt 0 view .LVU57
 224 00be 039B     		ldr	r3, [sp, #12]
  59:Src/VESC.c    ****           break;
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 7


 225              		.loc 1 59 12 view .LVU58
 226 00c0 072B     		cmp	r3, #7
 227 00c2 D1DD     		ble	.L1
  62:Src/VESC.c    ****         ptr->amp_hours_charged = (F32)buffer_pop_int32(buf, &index) / 1e4f;
 228              		.loc 1 62 9 is_stmt 1 view .LVU59
  62:Src/VESC.c    ****         ptr->amp_hours_charged = (F32)buffer_pop_int32(buf, &index) / 1e4f;
 229              		.loc 1 62 31 is_stmt 0 view .LVU60
 230 00c4 05A9     		add	r1, sp, #20
 231 00c6 01A8     		add	r0, sp, #4
 232              	.LVL19:
  62:Src/VESC.c    ****         ptr->amp_hours_charged = (F32)buffer_pop_int32(buf, &index) / 1e4f;
 233              		.loc 1 62 31 view .LVU61
 234 00c8 FFF7FEFF 		bl	buffer_pop_int32
 235              	.LVL20:
  62:Src/VESC.c    ****         ptr->amp_hours_charged = (F32)buffer_pop_int32(buf, &index) / 1e4f;
 236              		.loc 1 62 31 view .LVU62
 237 00cc 07EE900A 		vmov	s15, r0	@ int
  62:Src/VESC.c    ****         ptr->amp_hours_charged = (F32)buffer_pop_int32(buf, &index) / 1e4f;
 238              		.loc 1 62 26 view .LVU63
 239 00d0 F8EEE77A 		vcvt.f32.s32	s15, s15
  62:Src/VESC.c    ****         ptr->amp_hours_charged = (F32)buffer_pop_int32(buf, &index) / 1e4f;
 240              		.loc 1 62 61 view .LVU64
 241 00d4 9FED438A 		vldr.32	s16, .L17+12
 242 00d8 87EE887A 		vdiv.f32	s14, s15, s16
  62:Src/VESC.c    ****         ptr->amp_hours_charged = (F32)buffer_pop_int32(buf, &index) / 1e4f;
 243              		.loc 1 62 24 view .LVU65
 244 00dc 85ED057A 		vstr.32	s14, [r5, #20]
  63:Src/VESC.c    ****         break;
 245              		.loc 1 63 9 is_stmt 1 view .LVU66
  63:Src/VESC.c    ****         break;
 246              		.loc 1 63 39 is_stmt 0 view .LVU67
 247 00e0 05A9     		add	r1, sp, #20
 248 00e2 01A8     		add	r0, sp, #4
 249              	.LVL21:
  63:Src/VESC.c    ****         break;
 250              		.loc 1 63 39 view .LVU68
 251 00e4 FFF7FEFF 		bl	buffer_pop_int32
 252              	.LVL22:
  63:Src/VESC.c    ****         break;
 253              		.loc 1 63 39 view .LVU69
 254 00e8 07EE900A 		vmov	s15, r0	@ int
  63:Src/VESC.c    ****         break;
 255              		.loc 1 63 34 view .LVU70
 256 00ec F8EEE77A 		vcvt.f32.s32	s15, s15
  63:Src/VESC.c    ****         break;
 257              		.loc 1 63 69 view .LVU71
 258 00f0 87EE887A 		vdiv.f32	s14, s15, s16
  63:Src/VESC.c    ****         break;
 259              		.loc 1 63 32 view .LVU72
 260 00f4 85ED067A 		vstr.32	s14, [r5, #24]
  64:Src/VESC.c    ****       }
 261              		.loc 1 64 9 is_stmt 1 view .LVU73
 262 00f8 B6E7     		b	.L1
 263              	.LVL23:
 264              	.L11:
  67:Src/VESC.c    ****           break;
 265              		.loc 1 67 9 view .LVU74
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 8


  67:Src/VESC.c    ****           break;
 266              		.loc 1 67 16 is_stmt 0 view .LVU75
 267 00fa 039B     		ldr	r3, [sp, #12]
  67:Src/VESC.c    ****           break;
 268              		.loc 1 67 12 view .LVU76
 269 00fc 072B     		cmp	r3, #7
 270 00fe B3DD     		ble	.L1
  70:Src/VESC.c    ****         ptr->watt_hours_charged = (F32)buffer_pop_int32(buf, &index) / 1e4f;
 271              		.loc 1 70 9 is_stmt 1 view .LVU77
  70:Src/VESC.c    ****         ptr->watt_hours_charged = (F32)buffer_pop_int32(buf, &index) / 1e4f;
 272              		.loc 1 70 32 is_stmt 0 view .LVU78
 273 0100 05A9     		add	r1, sp, #20
 274 0102 01A8     		add	r0, sp, #4
 275              	.LVL24:
  70:Src/VESC.c    ****         ptr->watt_hours_charged = (F32)buffer_pop_int32(buf, &index) / 1e4f;
 276              		.loc 1 70 32 view .LVU79
 277 0104 FFF7FEFF 		bl	buffer_pop_int32
 278              	.LVL25:
  70:Src/VESC.c    ****         ptr->watt_hours_charged = (F32)buffer_pop_int32(buf, &index) / 1e4f;
 279              		.loc 1 70 32 view .LVU80
 280 0108 07EE900A 		vmov	s15, r0	@ int
  70:Src/VESC.c    ****         ptr->watt_hours_charged = (F32)buffer_pop_int32(buf, &index) / 1e4f;
 281              		.loc 1 70 27 view .LVU81
 282 010c F8EEE77A 		vcvt.f32.s32	s15, s15
  70:Src/VESC.c    ****         ptr->watt_hours_charged = (F32)buffer_pop_int32(buf, &index) / 1e4f;
 283              		.loc 1 70 62 view .LVU82
 284 0110 9FED348A 		vldr.32	s16, .L17+12
 285 0114 87EE887A 		vdiv.f32	s14, s15, s16
  70:Src/VESC.c    ****         ptr->watt_hours_charged = (F32)buffer_pop_int32(buf, &index) / 1e4f;
 286              		.loc 1 70 25 view .LVU83
 287 0118 85ED077A 		vstr.32	s14, [r5, #28]
  71:Src/VESC.c    ****         break;
 288              		.loc 1 71 9 is_stmt 1 view .LVU84
  71:Src/VESC.c    ****         break;
 289              		.loc 1 71 40 is_stmt 0 view .LVU85
 290 011c 05A9     		add	r1, sp, #20
 291 011e 01A8     		add	r0, sp, #4
 292              	.LVL26:
  71:Src/VESC.c    ****         break;
 293              		.loc 1 71 40 view .LVU86
 294 0120 FFF7FEFF 		bl	buffer_pop_int32
 295              	.LVL27:
  71:Src/VESC.c    ****         break;
 296              		.loc 1 71 40 view .LVU87
 297 0124 07EE900A 		vmov	s15, r0	@ int
  71:Src/VESC.c    ****         break;
 298              		.loc 1 71 35 view .LVU88
 299 0128 F8EEE77A 		vcvt.f32.s32	s15, s15
  71:Src/VESC.c    ****         break;
 300              		.loc 1 71 70 view .LVU89
 301 012c 87EE887A 		vdiv.f32	s14, s15, s16
  71:Src/VESC.c    ****         break;
 302              		.loc 1 71 33 view .LVU90
 303 0130 85ED087A 		vstr.32	s14, [r5, #32]
  72:Src/VESC.c    ****       }
 304              		.loc 1 72 9 is_stmt 1 view .LVU91
 305 0134 98E7     		b	.L1
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 9


 306              	.LVL28:
 307              	.L10:
  75:Src/VESC.c    ****           break;
 308              		.loc 1 75 9 view .LVU92
  75:Src/VESC.c    ****           break;
 309              		.loc 1 75 16 is_stmt 0 view .LVU93
 310 0136 039B     		ldr	r3, [sp, #12]
  75:Src/VESC.c    ****           break;
 311              		.loc 1 75 12 view .LVU94
 312 0138 072B     		cmp	r3, #7
 313 013a 95DD     		ble	.L1
  78:Src/VESC.c    ****         ptr->temp_motor = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 314              		.loc 1 78 9 is_stmt 1 view .LVU95
  78:Src/VESC.c    ****         ptr->temp_motor = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 315              		.loc 1 78 30 is_stmt 0 view .LVU96
 316 013c 05A9     		add	r1, sp, #20
 317 013e 01A8     		add	r0, sp, #4
 318              	.LVL29:
  78:Src/VESC.c    ****         ptr->temp_motor = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 319              		.loc 1 78 30 view .LVU97
 320 0140 FFF7FEFF 		bl	buffer_pop_int16
 321              	.LVL30:
  78:Src/VESC.c    ****         ptr->temp_motor = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 322              		.loc 1 78 30 view .LVU98
 323 0144 07EE900A 		vmov	s15, r0	@ int
  78:Src/VESC.c    ****         ptr->temp_motor = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 324              		.loc 1 78 25 view .LVU99
 325 0148 F8EEE77A 		vcvt.f32.s32	s15, s15
  78:Src/VESC.c    ****         ptr->temp_motor = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 326              		.loc 1 78 60 view .LVU100
 327 014c B2EE048A 		vmov.f32	s16, #1.0e+1
 328 0150 87EE887A 		vdiv.f32	s14, s15, s16
  78:Src/VESC.c    ****         ptr->temp_motor = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 329              		.loc 1 78 23 view .LVU101
 330 0154 85ED097A 		vstr.32	s14, [r5, #36]
  79:Src/VESC.c    ****         ptr->current_in = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 331              		.loc 1 79 9 is_stmt 1 view .LVU102
  79:Src/VESC.c    ****         ptr->current_in = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 332              		.loc 1 79 32 is_stmt 0 view .LVU103
 333 0158 05A9     		add	r1, sp, #20
 334 015a 01A8     		add	r0, sp, #4
 335              	.LVL31:
  79:Src/VESC.c    ****         ptr->current_in = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 336              		.loc 1 79 32 view .LVU104
 337 015c FFF7FEFF 		bl	buffer_pop_int16
 338              	.LVL32:
  79:Src/VESC.c    ****         ptr->current_in = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 339              		.loc 1 79 32 view .LVU105
 340 0160 07EE900A 		vmov	s15, r0	@ int
  79:Src/VESC.c    ****         ptr->current_in = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 341              		.loc 1 79 27 view .LVU106
 342 0164 F8EEE77A 		vcvt.f32.s32	s15, s15
  79:Src/VESC.c    ****         ptr->current_in = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 343              		.loc 1 79 62 view .LVU107
 344 0168 87EE887A 		vdiv.f32	s14, s15, s16
  79:Src/VESC.c    ****         ptr->current_in = (F32)buffer_pop_int16(buf, &index) / 10.0f;
 345              		.loc 1 79 25 view .LVU108
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 10


 346 016c 85ED0A7A 		vstr.32	s14, [r5, #40]
  80:Src/VESC.c    ****         ptr->pid_pos_now = (F32)buffer_pop_int16(buf, &index) / 50.0f;
 347              		.loc 1 80 9 is_stmt 1 view .LVU109
  80:Src/VESC.c    ****         ptr->pid_pos_now = (F32)buffer_pop_int16(buf, &index) / 50.0f;
 348              		.loc 1 80 32 is_stmt 0 view .LVU110
 349 0170 05A9     		add	r1, sp, #20
 350 0172 01A8     		add	r0, sp, #4
 351              	.LVL33:
  80:Src/VESC.c    ****         ptr->pid_pos_now = (F32)buffer_pop_int16(buf, &index) / 50.0f;
 352              		.loc 1 80 32 view .LVU111
 353 0174 FFF7FEFF 		bl	buffer_pop_int16
 354              	.LVL34:
  80:Src/VESC.c    ****         ptr->pid_pos_now = (F32)buffer_pop_int16(buf, &index) / 50.0f;
 355              		.loc 1 80 32 view .LVU112
 356 0178 07EE900A 		vmov	s15, r0	@ int
  80:Src/VESC.c    ****         ptr->pid_pos_now = (F32)buffer_pop_int16(buf, &index) / 50.0f;
 357              		.loc 1 80 27 view .LVU113
 358 017c F8EEE77A 		vcvt.f32.s32	s15, s15
  80:Src/VESC.c    ****         ptr->pid_pos_now = (F32)buffer_pop_int16(buf, &index) / 50.0f;
 359              		.loc 1 80 62 view .LVU114
 360 0180 87EE887A 		vdiv.f32	s14, s15, s16
  80:Src/VESC.c    ****         ptr->pid_pos_now = (F32)buffer_pop_int16(buf, &index) / 50.0f;
 361              		.loc 1 80 25 view .LVU115
 362 0184 85ED0B7A 		vstr.32	s14, [r5, #44]
  81:Src/VESC.c    ****         break;
 363              		.loc 1 81 9 is_stmt 1 view .LVU116
  81:Src/VESC.c    ****         break;
 364              		.loc 1 81 33 is_stmt 0 view .LVU117
 365 0188 05A9     		add	r1, sp, #20
 366 018a 01A8     		add	r0, sp, #4
 367              	.LVL35:
  81:Src/VESC.c    ****         break;
 368              		.loc 1 81 33 view .LVU118
 369 018c FFF7FEFF 		bl	buffer_pop_int16
 370              	.LVL36:
  81:Src/VESC.c    ****         break;
 371              		.loc 1 81 33 view .LVU119
 372 0190 07EE900A 		vmov	s15, r0	@ int
  81:Src/VESC.c    ****         break;
 373              		.loc 1 81 28 view .LVU120
 374 0194 F8EEE77A 		vcvt.f32.s32	s15, s15
  81:Src/VESC.c    ****         break;
 375              		.loc 1 81 63 view .LVU121
 376 0198 DFED136A 		vldr.32	s13, .L17+16
 377 019c 87EEA67A 		vdiv.f32	s14, s15, s13
  81:Src/VESC.c    ****         break;
 378              		.loc 1 81 26 view .LVU122
 379 01a0 85ED0C7A 		vstr.32	s14, [r5, #48]
  82:Src/VESC.c    ****       }
 380              		.loc 1 82 9 is_stmt 1 view .LVU123
 381 01a4 60E7     		b	.L1
 382              	.LVL37:
 383              	.L8:
  85:Src/VESC.c    ****           break;
 384              		.loc 1 85 9 view .LVU124
  85:Src/VESC.c    ****           break;
 385              		.loc 1 85 16 is_stmt 0 view .LVU125
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 11


 386 01a6 039B     		ldr	r3, [sp, #12]
  85:Src/VESC.c    ****           break;
 387              		.loc 1 85 12 view .LVU126
 388 01a8 052B     		cmp	r3, #5
 389 01aa 7FF75DAF 		ble	.L1
  88:Src/VESC.c    ****         ptr->v_in = (F32)buffer_pop_int16(buf, &index) / 1e1f;
 390              		.loc 1 88 9 is_stmt 1 view .LVU127
  88:Src/VESC.c    ****         ptr->v_in = (F32)buffer_pop_int16(buf, &index) / 1e1f;
 391              		.loc 1 88 28 is_stmt 0 view .LVU128
 392 01ae 05A9     		add	r1, sp, #20
 393 01b0 01A8     		add	r0, sp, #4
 394              	.LVL38:
  88:Src/VESC.c    ****         ptr->v_in = (F32)buffer_pop_int16(buf, &index) / 1e1f;
 395              		.loc 1 88 28 view .LVU129
 396 01b2 FFF7FEFF 		bl	buffer_pop_int32
 397              	.LVL39:
  88:Src/VESC.c    ****         ptr->v_in = (F32)buffer_pop_int16(buf, &index) / 1e1f;
 398              		.loc 1 88 26 view .LVU130
 399 01b6 6863     		str	r0, [r5, #52]
  89:Src/VESC.c    ****         break;
 400              		.loc 1 89 9 is_stmt 1 view .LVU131
  89:Src/VESC.c    ****         break;
 401              		.loc 1 89 26 is_stmt 0 view .LVU132
 402 01b8 05A9     		add	r1, sp, #20
 403 01ba 01A8     		add	r0, sp, #4
 404              	.LVL40:
  89:Src/VESC.c    ****         break;
 405              		.loc 1 89 26 view .LVU133
 406 01bc FFF7FEFF 		bl	buffer_pop_int16
 407              	.LVL41:
  89:Src/VESC.c    ****         break;
 408              		.loc 1 89 26 view .LVU134
 409 01c0 07EE900A 		vmov	s15, r0	@ int
  89:Src/VESC.c    ****         break;
 410              		.loc 1 89 21 view .LVU135
 411 01c4 F8EEE77A 		vcvt.f32.s32	s15, s15
  89:Src/VESC.c    ****         break;
 412              		.loc 1 89 56 view .LVU136
 413 01c8 F2EE046A 		vmov.f32	s13, #1.0e+1
 414 01cc 87EEA67A 		vdiv.f32	s14, s15, s13
  89:Src/VESC.c    ****         break;
 415              		.loc 1 89 19 view .LVU137
 416 01d0 85ED0E7A 		vstr.32	s14, [r5, #56]
  90:Src/VESC.c    ****       }
 417              		.loc 1 90 9 is_stmt 1 view .LVU138
 418              	.LBE4:
 419              		.loc 1 94 1 is_stmt 0 view .LVU139
 420 01d4 48E7     		b	.L1
 421              	.L18:
 422 01d6 00BF     		.align	2
 423              	.L17:
 424 01d8 00000000 		.word	.LANCHOR1
 425 01dc 00000000 		.word	.LANCHOR0
 426 01e0 00007A44 		.word	1148846080
 427 01e4 00401C46 		.word	1176256512
 428 01e8 00004842 		.word	1112014848
 429              		.cfi_endproc
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 12


 430              	.LFE3:
 432              		.section	.text.vesc_system_init,"ax",%progbits
 433              		.align	1
 434              		.global	vesc_system_init
 435              		.syntax unified
 436              		.thumb
 437              		.thumb_func
 439              	vesc_system_init:
 440              	.LFB0:
  16:Src/VESC.c    ****   registerCANMsgHandler(0xFFFFFFFFu, handle_vesc_can_recv);
 441              		.loc 1 16 25 is_stmt 1 view -0
 442              		.cfi_startproc
 443              		@ args = 0, pretend = 0, frame = 0
 444              		@ frame_needed = 0, uses_anonymous_args = 0
 445 0000 08B5     		push	{r3, lr}
 446              	.LCFI6:
 447              		.cfi_def_cfa_offset 8
 448              		.cfi_offset 3, -8
 449              		.cfi_offset 14, -4
  17:Src/VESC.c    **** }
 450              		.loc 1 17 3 view .LVU141
 451 0002 0349     		ldr	r1, .L21
 452 0004 4FF0FF30 		mov	r0, #-1
 453 0008 FFF7FEFF 		bl	registerCANMsgHandler
 454              	.LVL42:
  18:Src/VESC.c    **** 
 455              		.loc 1 18 1 is_stmt 0 view .LVU142
 456 000c 08BD     		pop	{r3, pc}
 457              	.L22:
 458 000e 00BF     		.align	2
 459              	.L21:
 460 0010 00000000 		.word	handle_vesc_can_recv
 461              		.cfi_endproc
 462              	.LFE0:
 464              		.section	.text.vesc_send_message,"ax",%progbits
 465              		.align	1
 466              		.global	vesc_send_message
 467              		.syntax unified
 468              		.thumb
 469              		.thumb_func
 471              	vesc_send_message:
 472              	.LVL43:
 473              	.LFB1:
  21:Src/VESC.c    ****   do_send_can_message(type << 8u | vesc->id, buffer, length);
 474              		.loc 1 21 42 is_stmt 1 view -0
 475              		.cfi_startproc
 476              		@ args = 0, pretend = 0, frame = 0
 477              		@ frame_needed = 0, uses_anonymous_args = 0
  21:Src/VESC.c    ****   do_send_can_message(type << 8u | vesc->id, buffer, length);
 478              		.loc 1 21 42 is_stmt 0 view .LVU144
 479 0000 08B5     		push	{r3, lr}
 480              	.LCFI7:
 481              		.cfi_def_cfa_offset 8
 482              		.cfi_offset 3, -8
 483              		.cfi_offset 14, -4
 484 0002 8C46     		mov	ip, r1
 485 0004 1146     		mov	r1, r2
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 13


 486              	.LVL44:
  22:Src/VESC.c    **** }
 487              		.loc 1 22 3 is_stmt 1 view .LVU145
  22:Src/VESC.c    **** }
 488              		.loc 1 22 40 is_stmt 0 view .LVU146
 489 0006 0078     		ldrb	r0, [r0]	@ zero_extendqisi2
 490              	.LVL45:
  22:Src/VESC.c    **** }
 491              		.loc 1 22 3 view .LVU147
 492 0008 1A46     		mov	r2, r3
 493              	.LVL46:
  22:Src/VESC.c    **** }
 494              		.loc 1 22 3 view .LVU148
 495 000a 40EA0C20 		orr	r0, r0, ip, lsl #8
 496 000e FFF7FEFF 		bl	do_send_can_message
 497              	.LVL47:
  23:Src/VESC.c    **** 
 498              		.loc 1 23 1 view .LVU149
 499 0012 08BD     		pop	{r3, pc}
 500              		.cfi_endproc
 501              	.LFE1:
 503              		.section	.text.create_vesc,"ax",%progbits
 504              		.align	1
 505              		.global	create_vesc
 506              		.syntax unified
 507              		.thumb
 508              		.thumb_func
 510              	create_vesc:
 511              	.LVL48:
 512              	.LFB2:
  25:Src/VESC.c    ****   VESC* vesc = &vesc_map[vesc_count];
 513              		.loc 1 25 54 is_stmt 1 view -0
 514              		.cfi_startproc
 515              		@ args = 0, pretend = 0, frame = 0
 516              		@ frame_needed = 0, uses_anonymous_args = 0
 517              		@ link register save eliminated.
  25:Src/VESC.c    ****   VESC* vesc = &vesc_map[vesc_count];
 518              		.loc 1 25 54 is_stmt 0 view .LVU151
 519 0000 30B4     		push	{r4, r5}
 520              	.LCFI8:
 521              		.cfi_def_cfa_offset 8
 522              		.cfi_offset 4, -8
 523              		.cfi_offset 5, -4
  26:Src/VESC.c    ****   ++vesc_count;
 524              		.loc 1 26 3 is_stmt 1 view .LVU152
  26:Src/VESC.c    ****   ++vesc_count;
 525              		.loc 1 26 25 is_stmt 0 view .LVU153
 526 0002 074C     		ldr	r4, .L27
 527 0004 2368     		ldr	r3, [r4]
  26:Src/VESC.c    ****   ++vesc_count;
 528              		.loc 1 26 9 view .LVU154
 529 0006 074A     		ldr	r2, .L27+4
 530 0008 C3EB031C 		rsb	ip, r3, r3, lsl #4
 531              	.LVL49:
  27:Src/VESC.c    ****   vesc->id = id;
 532              		.loc 1 27 3 is_stmt 1 view .LVU155
 533 000c 5D1C     		adds	r5, r3, #1
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 14


 534 000e 2560     		str	r5, [r4]
  28:Src/VESC.c    ****   vesc->pole_pairs = pole_pairs;
 535              		.loc 1 28 3 view .LVU156
  28:Src/VESC.c    ****   vesc->pole_pairs = pole_pairs;
 536              		.loc 1 28 12 is_stmt 0 view .LVU157
 537 0010 02F82C00 		strb	r0, [r2, ip, lsl #2]
  29:Src/VESC.c    ****   return vesc;
 538              		.loc 1 29 3 is_stmt 1 view .LVU158
  29:Src/VESC.c    ****   return vesc;
 539              		.loc 1 29 20 is_stmt 0 view .LVU159
 540 0014 02EB8C03 		add	r3, r2, ip, lsl #2
 541              	.LVL50:
  29:Src/VESC.c    ****   return vesc;
 542              		.loc 1 29 20 view .LVU160
 543 0018 5960     		str	r1, [r3, #4]
  30:Src/VESC.c    **** }
 544              		.loc 1 30 3 is_stmt 1 view .LVU161
  31:Src/VESC.c    **** 
 545              		.loc 1 31 1 is_stmt 0 view .LVU162
 546 001a 1846     		mov	r0, r3
 547              	.LVL51:
  31:Src/VESC.c    **** 
 548              		.loc 1 31 1 view .LVU163
 549 001c 30BC     		pop	{r4, r5}
 550              	.LCFI9:
 551              		.cfi_restore 5
 552              		.cfi_restore 4
 553              		.cfi_def_cfa_offset 0
 554 001e 7047     		bx	lr
 555              	.L28:
 556              		.align	2
 557              	.L27:
 558 0020 00000000 		.word	.LANCHOR1
 559 0024 00000000 		.word	.LANCHOR0
 560              		.cfi_endproc
 561              	.LFE2:
 563              		.global	__aeabi_f2d
 564              		.global	__aeabi_dmul
 565              		.global	__aeabi_d2iz
 566              		.section	.text.vesc_set_duty_cycle,"ax",%progbits
 567              		.align	1
 568              		.global	vesc_set_duty_cycle
 569              		.syntax unified
 570              		.thumb
 571              		.thumb_func
 573              	vesc_set_duty_cycle:
 574              	.LVL52:
 575              	.LFB4:
  95:Src/VESC.c    **** 
  96:Src/VESC.c    **** void vesc_set_duty_cycle(VESC const* vesc, F32 const duty_cycle) {
 576              		.loc 1 96 66 is_stmt 1 view -0
 577              		.cfi_startproc
 578              		@ args = 0, pretend = 0, frame = 8
 579              		@ frame_needed = 0, uses_anonymous_args = 0
 580              		.loc 1 96 66 is_stmt 0 view .LVU165
 581 0000 30B5     		push	{r4, r5, lr}
 582              	.LCFI10:
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 15


 583              		.cfi_def_cfa_offset 12
 584              		.cfi_offset 4, -12
 585              		.cfi_offset 5, -8
 586              		.cfi_offset 14, -4
 587 0002 83B0     		sub	sp, sp, #12
 588              	.LCFI11:
 589              		.cfi_def_cfa_offset 24
 590 0004 0446     		mov	r4, r0
 591 0006 10EE100A 		vmov	r0, s0
 592              	.LVL53:
  97:Src/VESC.c    ****   U8 buffer[4];
 593              		.loc 1 97 3 is_stmt 1 view .LVU166
  98:Src/VESC.c    ****   S32 val = (S32)(duty_cycle * 100000.0);
 594              		.loc 1 98 3 view .LVU167
 595              		.loc 1 98 30 is_stmt 0 view .LVU168
 596 000a FFF7FEFF 		bl	__aeabi_f2d
 597              	.LVL54:
 598              		.loc 1 98 30 view .LVU169
 599 000e 0CA3     		adr	r3, .L31
 600 0010 D3E90023 		ldrd	r2, [r3]
 601 0014 FFF7FEFF 		bl	__aeabi_dmul
 602              	.LVL55:
 603              		.loc 1 98 7 view .LVU170
 604 0018 FFF7FEFF 		bl	__aeabi_d2iz
 605              	.LVL56:
 606 001c 0246     		mov	r2, r0
 607              	.LVL57:
  99:Src/VESC.c    ****   S32 index = 0;
 608              		.loc 1 99 3 is_stmt 1 view .LVU171
 609              		.loc 1 99 7 is_stmt 0 view .LVU172
 610 001e 0025     		movs	r5, #0
 611 0020 0095     		str	r5, [sp]
 100:Src/VESC.c    ****   buffer_put_int32(buffer, &index, val);
 612              		.loc 1 100 3 is_stmt 1 view .LVU173
 613 0022 6946     		mov	r1, sp
 614 0024 01A8     		add	r0, sp, #4
 615              	.LVL58:
 616              		.loc 1 100 3 is_stmt 0 view .LVU174
 617 0026 FFF7FEFF 		bl	buffer_put_int32
 618              	.LVL59:
 101:Src/VESC.c    ****   vesc_send_message(vesc, VESC_PACKET_SET_DUTY, buffer, 4);
 619              		.loc 1 101 3 is_stmt 1 view .LVU175
 620 002a 0423     		movs	r3, #4
 621 002c 0DEB0302 		add	r2, sp, r3
 622 0030 2946     		mov	r1, r5
 623 0032 2046     		mov	r0, r4
 624 0034 FFF7FEFF 		bl	vesc_send_message
 625              	.LVL60:
 102:Src/VESC.c    **** }
 626              		.loc 1 102 1 is_stmt 0 view .LVU176
 627 0038 03B0     		add	sp, sp, #12
 628              	.LCFI12:
 629              		.cfi_def_cfa_offset 12
 630              		@ sp needed
 631 003a 30BD     		pop	{r4, r5, pc}
 632              	.LVL61:
 633              	.L32:
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 16


 634              		.loc 1 102 1 view .LVU177
 635 003c AFF30080 		.align	3
 636              	.L31:
 637 0040 00000000 		.word	0
 638 0044 006AF840 		.word	1090021888
 639              		.cfi_endproc
 640              	.LFE4:
 642              		.section	.text.vesc_set_rpm,"ax",%progbits
 643              		.align	1
 644              		.global	vesc_set_rpm
 645              		.syntax unified
 646              		.thumb
 647              		.thumb_func
 649              	vesc_set_rpm:
 650              	.LVL62:
 651              	.LFB5:
 103:Src/VESC.c    **** 
 104:Src/VESC.c    **** void vesc_set_rpm(VESC const* vesc, F32 const rpm) {
 652              		.loc 1 104 52 is_stmt 1 view -0
 653              		.cfi_startproc
 654              		@ args = 0, pretend = 0, frame = 8
 655              		@ frame_needed = 0, uses_anonymous_args = 0
 656              		.loc 1 104 52 is_stmt 0 view .LVU179
 657 0000 10B5     		push	{r4, lr}
 658              	.LCFI13:
 659              		.cfi_def_cfa_offset 8
 660              		.cfi_offset 4, -8
 661              		.cfi_offset 14, -4
 662 0002 82B0     		sub	sp, sp, #8
 663              	.LCFI14:
 664              		.cfi_def_cfa_offset 16
 665 0004 0446     		mov	r4, r0
 105:Src/VESC.c    ****   // Normalize rpm to erpm
 106:Src/VESC.c    ****   U8 buffer[4];
 666              		.loc 1 106 3 is_stmt 1 view .LVU180
 107:Src/VESC.c    ****   S32 val = (S32)(rpm * vesc->pole_pairs);
 667              		.loc 1 107 3 view .LVU181
 668              		.loc 1 107 23 is_stmt 0 view .LVU182
 669 0006 D0ED017A 		vldr.32	s15, [r0, #4]	@ int
 670 000a F8EEE77A 		vcvt.f32.s32	s15, s15
 671 000e 67EE807A 		vmul.f32	s15, s15, s0
 672              	.LVL63:
 108:Src/VESC.c    ****   S32 index = 0;
 673              		.loc 1 108 3 is_stmt 1 view .LVU183
 674              		.loc 1 108 7 is_stmt 0 view .LVU184
 675 0012 0023     		movs	r3, #0
 676 0014 0093     		str	r3, [sp]
 109:Src/VESC.c    ****   buffer_put_int32(buffer, &index, val);
 677              		.loc 1 109 3 is_stmt 1 view .LVU185
 678 0016 FDEEE77A 		vcvt.s32.f32	s15, s15
 679              	.LVL64:
 680              		.loc 1 109 3 is_stmt 0 view .LVU186
 681 001a 17EE902A 		vmov	r2, s15	@ int
 682 001e 6946     		mov	r1, sp
 683 0020 01A8     		add	r0, sp, #4
 684              	.LVL65:
 685              		.loc 1 109 3 view .LVU187
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 17


 686 0022 FFF7FEFF 		bl	buffer_put_int32
 687              	.LVL66:
 110:Src/VESC.c    ****   vesc_send_message(vesc, VESC_PACKET_SET_RPM, buffer, 4);
 688              		.loc 1 110 3 is_stmt 1 view .LVU188
 689 0026 0423     		movs	r3, #4
 690 0028 0DEB0302 		add	r2, sp, r3
 691 002c 0321     		movs	r1, #3
 692 002e 2046     		mov	r0, r4
 693 0030 FFF7FEFF 		bl	vesc_send_message
 694              	.LVL67:
 111:Src/VESC.c    **** }
 695              		.loc 1 111 1 is_stmt 0 view .LVU189
 696 0034 02B0     		add	sp, sp, #8
 697              	.LCFI15:
 698              		.cfi_def_cfa_offset 8
 699              		@ sp needed
 700 0036 10BD     		pop	{r4, pc}
 701              		.loc 1 111 1 view .LVU190
 702              		.cfi_endproc
 703              	.LFE5:
 705              		.section	.text.vesc_set_position,"ax",%progbits
 706              		.align	1
 707              		.global	vesc_set_position
 708              		.syntax unified
 709              		.thumb
 710              		.thumb_func
 712              	vesc_set_position:
 713              	.LVL68:
 714              	.LFB6:
 112:Src/VESC.c    **** 
 113:Src/VESC.c    **** void vesc_set_position(VESC const* vesc, F32 const pos) {
 715              		.loc 1 113 57 is_stmt 1 view -0
 716              		.cfi_startproc
 717              		@ args = 0, pretend = 0, frame = 8
 718              		@ frame_needed = 0, uses_anonymous_args = 0
 719              		.loc 1 113 57 is_stmt 0 view .LVU192
 720 0000 00B5     		push	{lr}
 721              	.LCFI16:
 722              		.cfi_def_cfa_offset 4
 723              		.cfi_offset 14, -4
 724 0002 83B0     		sub	sp, sp, #12
 725              	.LCFI17:
 726              		.cfi_def_cfa_offset 16
 114:Src/VESC.c    ****   // Multiply degrees to encoder counts
 115:Src/VESC.c    ****   U8 buffer[4];
 727              		.loc 1 115 3 is_stmt 1 view .LVU193
 116:Src/VESC.c    ****   S32 val = (S32)(6.0f * vesc->pole_pairs * 1000000.0f);
 728              		.loc 1 116 3 view .LVU194
 729              		.loc 1 116 30 is_stmt 0 view .LVU195
 730 0004 D0ED017A 		vldr.32	s15, [r0, #4]	@ int
 731              		.loc 1 116 24 view .LVU196
 732 0008 F8EEE77A 		vcvt.f32.s32	s15, s15
 733 000c B1EE087A 		vmov.f32	s14, #6.0e+0
 734 0010 67EE877A 		vmul.f32	s15, s15, s14
 735              		.loc 1 116 43 view .LVU197
 736 0014 9FED087A 		vldr.32	s14, .L37
 737 0018 67EE877A 		vmul.f32	s15, s15, s14
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 18


 738              		.loc 1 116 13 view .LVU198
 739 001c FDEEE77A 		vcvt.s32.f32	s15, s15
 740              	.LVL69:
 117:Src/VESC.c    ****   memcpy(buffer, &val, sizeof(U8) * 4);
 741              		.loc 1 117 3 is_stmt 1 view .LVU199
 742 0020 CDED017A 		vstr.32	s15, [sp, #4]	@ int
 118:Src/VESC.c    ****   vesc_send_message(vesc, VESC_PACKET_SET_POS, buffer, 4);
 743              		.loc 1 118 3 view .LVU200
 744 0024 0423     		movs	r3, #4
 745 0026 0DEB0302 		add	r2, sp, r3
 746 002a 1946     		mov	r1, r3
 747 002c FFF7FEFF 		bl	vesc_send_message
 748              	.LVL70:
 119:Src/VESC.c    **** }
 749              		.loc 1 119 1 is_stmt 0 view .LVU201
 750 0030 03B0     		add	sp, sp, #12
 751              	.LCFI18:
 752              		.cfi_def_cfa_offset 4
 753              		@ sp needed
 754 0032 5DF804FB 		ldr	pc, [sp], #4
 755              	.L38:
 756 0036 00BF     		.align	2
 757              	.L37:
 758 0038 00247449 		.word	1232348160
 759              		.cfi_endproc
 760              	.LFE6:
 762              		.section	.text.vesc_set_current,"ax",%progbits
 763              		.align	1
 764              		.global	vesc_set_current
 765              		.syntax unified
 766              		.thumb
 767              		.thumb_func
 769              	vesc_set_current:
 770              	.LVL71:
 771              	.LFB7:
 120:Src/VESC.c    **** 
 121:Src/VESC.c    **** void vesc_set_current(VESC const* vesc, F32 const current) {
 772              		.loc 1 121 60 is_stmt 1 view -0
 773              		.cfi_startproc
 774              		@ args = 0, pretend = 0, frame = 8
 775              		@ frame_needed = 0, uses_anonymous_args = 0
 776              		.loc 1 121 60 is_stmt 0 view .LVU203
 777 0000 10B5     		push	{r4, lr}
 778              	.LCFI19:
 779              		.cfi_def_cfa_offset 8
 780              		.cfi_offset 4, -8
 781              		.cfi_offset 14, -4
 782 0002 82B0     		sub	sp, sp, #8
 783              	.LCFI20:
 784              		.cfi_def_cfa_offset 16
 785 0004 0446     		mov	r4, r0
 786 0006 10EE100A 		vmov	r0, s0
 787              	.LVL72:
 122:Src/VESC.c    ****   U8 buffer[4];
 788              		.loc 1 122 3 is_stmt 1 view .LVU204
 123:Src/VESC.c    ****   S32 val = (S32)(current * 1000.0);
 789              		.loc 1 123 3 view .LVU205
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 19


 790              		.loc 1 123 27 is_stmt 0 view .LVU206
 791 000a FFF7FEFF 		bl	__aeabi_f2d
 792              	.LVL73:
 793              		.loc 1 123 27 view .LVU207
 794 000e 0022     		movs	r2, #0
 795 0010 074B     		ldr	r3, .L41
 796 0012 FFF7FEFF 		bl	__aeabi_dmul
 797              	.LVL74:
 798              		.loc 1 123 13 view .LVU208
 799 0016 FFF7FEFF 		bl	__aeabi_d2iz
 800              	.LVL75:
 124:Src/VESC.c    ****   memcpy(buffer, &val, sizeof(U8) * 4);
 801              		.loc 1 124 3 is_stmt 1 view .LVU209
 802 001a 0190     		str	r0, [sp, #4]
 125:Src/VESC.c    ****   vesc_send_message(vesc, VESC_PACKET_SET_CURRENT, buffer, 4);
 803              		.loc 1 125 3 view .LVU210
 804 001c 0423     		movs	r3, #4
 805 001e 0DEB0302 		add	r2, sp, r3
 806 0022 0121     		movs	r1, #1
 807 0024 2046     		mov	r0, r4
 808              	.LVL76:
 809              		.loc 1 125 3 is_stmt 0 view .LVU211
 810 0026 FFF7FEFF 		bl	vesc_send_message
 811              	.LVL77:
 126:Src/VESC.c    **** }
 812              		.loc 1 126 1 view .LVU212
 813 002a 02B0     		add	sp, sp, #8
 814              	.LCFI21:
 815              		.cfi_def_cfa_offset 8
 816              		@ sp needed
 817 002c 10BD     		pop	{r4, pc}
 818              	.LVL78:
 819              	.L42:
 820              		.loc 1 126 1 view .LVU213
 821 002e 00BF     		.align	2
 822              	.L41:
 823 0030 00408F40 		.word	1083129856
 824              		.cfi_endproc
 825              	.LFE7:
 827              		.section	.text.vesc_get_rpm,"ax",%progbits
 828              		.align	1
 829              		.global	vesc_get_rpm
 830              		.syntax unified
 831              		.thumb
 832              		.thumb_func
 834              	vesc_get_rpm:
 835              	.LVL79:
 836              	.LFB8:
 127:Src/VESC.c    **** 
 128:Src/VESC.c    **** F32 vesc_get_rpm(VESC const* vesc) { return vesc->erpm / vesc->pole_pairs; }
 837              		.loc 1 128 36 is_stmt 1 view -0
 838              		.cfi_startproc
 839              		@ args = 0, pretend = 0, frame = 0
 840              		@ frame_needed = 0, uses_anonymous_args = 0
 841              		@ link register save eliminated.
 842              		.loc 1 128 38 view .LVU215
 843              		.loc 1 128 49 is_stmt 0 view .LVU216
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 20


 844 0000 90ED020A 		vldr.32	s0, [r0, #8]
 845              		.loc 1 128 62 view .LVU217
 846 0004 D0ED017A 		vldr.32	s15, [r0, #4]	@ int
 847              		.loc 1 128 56 view .LVU218
 848 0008 F8EEE77A 		vcvt.f32.s32	s15, s15
 849              		.loc 1 128 76 view .LVU219
 850 000c 80EE270A 		vdiv.f32	s0, s0, s15
 851 0010 7047     		bx	lr
 852              		.cfi_endproc
 853              	.LFE8:
 855              		.section	.text.vesc_get_position,"ax",%progbits
 856              		.align	1
 857              		.global	vesc_get_position
 858              		.syntax unified
 859              		.thumb
 860              		.thumb_func
 862              	vesc_get_position:
 863              	.LVL80:
 864              	.LFB9:
 129:Src/VESC.c    **** 
 130:Src/VESC.c    **** F32 vesc_get_position(VESC const* vesc) {
 865              		.loc 1 130 41 is_stmt 1 view -0
 866              		.cfi_startproc
 867              		@ args = 0, pretend = 0, frame = 0
 868              		@ frame_needed = 0, uses_anonymous_args = 0
 869              		@ link register save eliminated.
 131:Src/VESC.c    ****   return 360.0f * vesc->tacho_value / (6.0f * vesc->pole_pairs);
 870              		.loc 1 131 3 view .LVU221
 871              		.loc 1 131 17 is_stmt 0 view .LVU222
 872 0000 D0ED0D7A 		vldr.32	s15, [r0, #52]	@ int
 873 0004 B8EEE70A 		vcvt.f32.s32	s0, s15
 874 0008 DFED077A 		vldr.32	s15, .L45
 875 000c 20EE270A 		vmul.f32	s0, s0, s15
 876              		.loc 1 131 51 view .LVU223
 877 0010 D0ED017A 		vldr.32	s15, [r0, #4]	@ int
 878              		.loc 1 131 45 view .LVU224
 879 0014 F8EEE77A 		vcvt.f32.s32	s15, s15
 880 0018 B1EE087A 		vmov.f32	s14, #6.0e+0
 881 001c 67EE877A 		vmul.f32	s15, s15, s14
 132:Src/VESC.c    **** }
 882              		.loc 1 132 1 view .LVU225
 883 0020 80EE270A 		vdiv.f32	s0, s0, s15
 884 0024 7047     		bx	lr
 885              	.L46:
 886 0026 00BF     		.align	2
 887              	.L45:
 888 0028 0000B443 		.word	1135869952
 889              		.cfi_endproc
 890              	.LFE9:
 892              		.global	vesc_map
 893              		.section	.bss.vesc_count,"aw",%nobits
 894              		.align	2
 895              		.set	.LANCHOR1,. + 0
 898              	vesc_count:
 899 0000 00000000 		.space	4
 900              		.section	.bss.vesc_map,"aw",%nobits
 901              		.align	2
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 21


 902              		.set	.LANCHOR0,. + 0
 905              	vesc_map:
 906 0000 00000000 		.space	960
 906      00000000 
 906      00000000 
 906      00000000 
 906      00000000 
 907              		.text
 908              	.Letext0:
 909              		.file 2 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 910              		.file 3 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 911              		.file 4 "Inc/types.h"
 912              		.file 5 "Inc/can_manager.h"
 913              		.file 6 "Inc/VESC.h"
 914              		.file 7 "Inc/buffer.h"
ARM GAS  C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s 			page 22


DEFINED SYMBOLS
                            *ABS*:00000000 VESC.c
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:20     .text.handle_vesc_can_recv:00000000 $t
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:26     .text.handle_vesc_can_recv:00000000 handle_vesc_can_recv
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:122    .text.handle_vesc_can_recv:0000004e $d
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:424    .text.handle_vesc_can_recv:000001d8 $d
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:433    .text.vesc_system_init:00000000 $t
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:439    .text.vesc_system_init:00000000 vesc_system_init
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:460    .text.vesc_system_init:00000010 $d
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:465    .text.vesc_send_message:00000000 $t
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:471    .text.vesc_send_message:00000000 vesc_send_message
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:504    .text.create_vesc:00000000 $t
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:510    .text.create_vesc:00000000 create_vesc
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:558    .text.create_vesc:00000020 $d
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:567    .text.vesc_set_duty_cycle:00000000 $t
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:573    .text.vesc_set_duty_cycle:00000000 vesc_set_duty_cycle
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:637    .text.vesc_set_duty_cycle:00000040 $d
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:643    .text.vesc_set_rpm:00000000 $t
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:649    .text.vesc_set_rpm:00000000 vesc_set_rpm
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:706    .text.vesc_set_position:00000000 $t
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:712    .text.vesc_set_position:00000000 vesc_set_position
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:758    .text.vesc_set_position:00000038 $d
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:763    .text.vesc_set_current:00000000 $t
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:769    .text.vesc_set_current:00000000 vesc_set_current
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:823    .text.vesc_set_current:00000030 $d
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:828    .text.vesc_get_rpm:00000000 $t
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:834    .text.vesc_get_rpm:00000000 vesc_get_rpm
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:856    .text.vesc_get_position:00000000 $t
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:862    .text.vesc_get_position:00000000 vesc_get_position
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:888    .text.vesc_get_position:00000028 $d
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:905    .bss.vesc_map:00000000 vesc_map
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:894    .bss.vesc_count:00000000 $d
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:898    .bss.vesc_count:00000000 vesc_count
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:901    .bss.vesc_map:00000000 $d
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:141    .text.handle_vesc_can_recv:00000061 $d
C:\Users\jmbli\AppData\Local\Temp\cc4tV6Ad.s:141    .text.handle_vesc_can_recv:00000062 $t

UNDEFINED SYMBOLS
buffer_pop_int32
buffer_pop_int16
registerCANMsgHandler
do_send_can_message
__aeabi_f2d
__aeabi_dmul
__aeabi_d2iz
buffer_put_int32
